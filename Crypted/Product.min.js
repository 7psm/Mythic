document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".floating-container"),t=document.querySelectorAll(".pricing-option"),o=(document.querySelector(".add-to-cart-button"),document.querySelector(".cart-count"));let n="50",l=t.length>0?t[0]:null,a=null;const i=()=>{const e=JSON.parse(localStorage.getItem("cart")||"[]").reduce((e,t)=>e+(t.quantity||0),0);o&&(e>0?(o.textContent=e,o.style.display="flex"):(o.textContent="",o.style.display="none"))},r=(e,t,o)=>{e.forEach(e=>e.classList.remove(o)),t&&t.classList.add(o)},s=(e=1)=>{if(l)try{const t=JSON.parse(localStorage.getItem("cart")||"[]"),o=parseFloat(l.dataset.price);if(isNaN(o))return void console.error("Prix invalide:",l.dataset.price);const r=(o*e).toFixed(2),s=l.dataset.name||l.querySelector(".amount")?.textContent||"Produit";let c="/public/50euro.png";"50"===n?c="/public/50euro.png":"20"===n&&(c="/public/20euro.png"),console.log("Ajout au panier:",{productName:s,price:o,selectedBill:n,productImage:c});const d=t.findIndex(e=>e.name===s&&Math.abs(e.price-o)<.01);-1!==d?(t[d].quantity+=e,console.log("Quantité mise à jour pour:",s)):(t.push({id:Date.now().toString(),name:s,price:o,quantity:e,image:c}),console.log("Nouveau produit ajouté:",s)),localStorage.setItem("cart",JSON.stringify(t)),i(),(e=>{a||(a=document.getElementById("toast-container")||document.createElement("div"),a.id="toast-container",a.style.cssText="\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        z-index: 9999;\n        pointer-events: none;\n      ",document.body.appendChild(a));const t=document.createElement("div");t.className="toast",t.style.cssText="\n      background-color: #111015;\n      color: white;\n      padding: 12px 16px;\n      margin-bottom: 12px;\n      border-left: 3px solid #d4af37;\n      border-radius: 6px;\n      max-width: 320px;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n      font-family: Arial, sans-serif;\n      pointer-events: auto;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    ",t.innerHTML=`\n      <div style="display: flex; align-items: flex-start; gap: 12px;">\n        \x3c!-- ✅ Check icon à gauche --\x3e\n        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"\n          stroke="#d4af37" style="width: 16px; height: 16px; margin-top: 15px; flex-shrink: 0;">\n          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>\n        </svg>\n\n        \x3c!-- ✅ Texte + lien décalés vers la droite --\x3e\n        <div style="flex: 1; margin-left: 4px;">\n          <div style="line-height: 1.4; margin-bottom: 8px;">\n            <span style="color: #d4af37; font-weight: 600;">${e}</span>\n            <span style="color: #d1d1d1;"> Ajouté au Panier</span>\n          </div>\n\n          <a href="Cart.html" style="color: #d4af37; font-weight: 600; text-decoration: none; display: inline-block; font-size: 14px;">\n            Voir le Panier &rsaquo;\n          </a>\n        </div>\n      </div>\n    `,a.appendChild(t),requestAnimationFrame(()=>{t.style.opacity="1"}),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.parentNode&&t.remove()},300)},4e3)})(s),console.log("Produit ajouté au panier:",{productName:s,quantity:e,price:o,totalPrice:r})}catch(e){console.error("Erreur lors de l'ajout au panier:",e)}else console.error("Aucune option de prix sélectionnée")};e.forEach(t=>{t.addEventListener("click",()=>{n=t.dataset.bill,console.log("Billet sélectionné:",n),r(e,t,"active"),document.querySelectorAll(".product-display").forEach(e=>{e.dataset.bill===n?e.style.display="block":e.style.display="none"});const o=document.querySelectorAll(`.product-display[data-bill="${n}"] .pricing-option`);o.length>0&&(l=o[0],document.querySelectorAll(".pricing-option").forEach(e=>e.classList.remove("selected")),l.classList.add("selected"),console.log("Option sélectionnée:",l.dataset.name||l.querySelector(".amount")?.textContent))})}),t.forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".product-display");if(t&&t.dataset.bill===n){l=e;const o=t.querySelectorAll(".pricing-option");r(o,e,"selected"),console.log("Option sélectionnée:",e.dataset.name||e.querySelector(".amount")?.textContent)}})});document.querySelectorAll(".add-to-cart-button").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.closest(".product-display");(o?o.dataset.bill:null)===n?s(1):console.warn("Le bouton ne correspond pas au billet sélectionné")})});(()=>{const e=document.querySelector(`[data-bill="${n}"]`);e&&e.classList.add("active")})(),document.querySelectorAll(".product-display").forEach(e=>{e.dataset.bill===n?e.style.display="block":e.style.display="none"}),document.querySelectorAll(".product-display").forEach(e=>{e.querySelectorAll(".pricing-option").forEach((t,o)=>{0===o?(t.classList.add("selected"),e.dataset.bill===n&&(l=t,console.log("Option par défaut:",t.dataset.name||t.querySelector(".amount")?.textContent))):t.classList.remove("selected")})}),i()});