document.addEventListener("DOMContentLoaded",()=>{const o=document.querySelectorAll(".floating-container"),t=document.querySelectorAll(".pricing-option"),n=(document.querySelector(".add-to-cart-button"),document.querySelector(".cart-count"));let e="50",c=t.length>0?t[0]:null,i=null;const a=()=>{const o=JSON.parse(localStorage.getItem("cart")||"[]").reduce((o,t)=>o+(t.quantity||0),0);n&&(o>0?(n.textContent=o,n.style.display="flex"):(n.textContent="",n.style.display="none"))},r=(o,t,n)=>{o.forEach(o=>o.classList.remove(n)),t&&t.classList.add(n)},l=(o=1)=>{if(c)try{const t=JSON.parse(localStorage.getItem("cart")||"[]"),n=parseFloat(c.dataset.price);if(isNaN(n))return void console.error("Prix invalide:",c.dataset.price);const r=(n*o).toFixed(2),l=c.dataset.name||c.querySelector(".amount")?.textContent||"Produit";let d="/public/normal/50euro.webp";"50"===e?d="/public/normal/50euro.webp":"20"===e?d="/public/normal/20euro.webp":"10"===e?d="/public/normal/10euro.webp":"5"===e&&(d="/public/normal/5euro.webp"),console.log("Ajout au panier:",{productName:l,price:n,selectedBill:e,productImage:d});const s=t.findIndex(o=>o.name===l&&Math.abs(o.price-n)<.01);-1!==s?(t[s].quantity+=o,console.log("Quantité mise à jour pour:",l)):(t.push({id:Date.now().toString(),name:l,price:n,quantity:o,image:d}),console.log("Nouveau produit ajouté:",l)),localStorage.setItem("cart",JSON.stringify(t)),a(),(o=>{i||(i=document.getElementById("toast-container")||document.createElement("div"),i.id="toast-container",i.style.cssText="\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        z-index: 9999;\n        pointer-events: none;\n      ",document.body.appendChild(i));const t=document.createElement("div");t.className="toast",t.style.cssText="\n      background-color: #111015;\n      color: white;\n      padding: 12px 16px;\n      margin-bottom: 12px;\n      border-left: 3px solid #d4af37;\n      border-radius: 6px;\n      max-width: 320px;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n      font-family: Arial, sans-serif;\n      pointer-events: auto;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n    ";const n=document.createElement("div");n.style.display="flex",n.style.alignItems="flex-start",n.style.gap="12px";const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("fill","none"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("stroke","#d4af37"),e.style.width="16px",e.style.height="16px",e.style.marginTop="15px",e.style.flexShrink="0";const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-width","2"),c.setAttribute("d","M5 13l4 4L19 7"),e.appendChild(c);const a=document.createElement("div");a.style.flex="1",a.style.marginLeft="4px";const r=document.createElement("div");r.style.lineHeight="1.4",r.style.marginBottom="8px";const l=document.createElement("span");l.style.color="#d4af37",l.style.fontWeight="600",l.textContent=o;const d=document.createElement("span");d.style.color="#d1d1d1",d.textContent=" Ajouté au Panier",r.appendChild(l),r.appendChild(d);const s=document.createElement("a");s.href="Cart.html",s.style.color="#d4af37",s.style.fontWeight="600",s.style.textDecoration="none",s.style.display="inline-block",s.style.fontSize="14px",s.textContent="Voir le Panier ›",a.appendChild(r),a.appendChild(s),n.appendChild(e),n.appendChild(a),t.appendChild(n),i.appendChild(t),requestAnimationFrame(()=>{t.style.opacity="1"}),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.parentNode&&t.remove()},300)},4e3)})(l),console.log("Produit ajouté au panier:",{productName:l,quantity:o,price:n,totalPrice:r})}catch(o){console.error("Erreur lors de l'ajout au panier:",o)}else console.error("Aucune option de prix sélectionnée")};o.forEach(t=>{t.addEventListener("click",()=>{e=t.dataset.bill,console.log("Billet sélectionné:",e),r(o,t,"active"),d(e),document.querySelectorAll(".product-display").forEach(o=>{o.dataset.bill===e?o.style.display="block":o.style.display="none"});const n=document.querySelectorAll(`.product-display[data-bill="${e}"] .pricing-option`);n.length>0&&(c=n[0],document.querySelectorAll(".pricing-option").forEach(o=>o.classList.remove("selected")),c.classList.add("selected"),console.log("Option sélectionnée:",c.dataset.name||c.querySelector(".amount")?.textContent))})}),t.forEach(o=>{o.addEventListener("click",()=>{const t=o.closest(".product-display");if(t&&t.dataset.bill===e){c=o;const n=t.querySelectorAll(".pricing-option");r(n,o,"selected"),console.log("Option sélectionnée:",o.dataset.name||o.querySelector(".amount")?.textContent)}})});document.querySelectorAll(".add-to-cart-button").forEach(o=>{o.addEventListener("click",t=>{t.preventDefault();const n=o.closest(".product-display");(n?n.dataset.bill:null)===e?l(1):console.warn("Le bouton ne correspond pas au billet sélectionné")})});const d=t=>{const n=Array.from(o),e=(o,t)=>{o.classList.remove("center","left","right","hidden"),t&&o.classList.add(t)},c=n.length;if(0===c)return;const i=n.findIndex(o=>o.dataset.bill===t);if(-1===i)return;const a=(i-1+c)%c,r=(i+1)%c;n.forEach((o,t)=>{e(o,t===i?"center":t===a?"left":t===r?"right":"hidden")})};(()=>{const o=document.querySelector(`[data-bill="${e}"]`);o&&o.classList.add("active")})(),document.querySelectorAll(".product-display").forEach(o=>{o.dataset.bill===e?o.style.display="block":o.style.display="none"}),document.querySelectorAll(".product-display").forEach(o=>{o.querySelectorAll(".pricing-option").forEach((t,n)=>{0===n?(t.classList.add("selected"),o.dataset.bill===e&&(c=t,console.log("Option par défaut:",t.dataset.name||t.querySelector(".amount")?.textContent))):t.classList.remove("selected")})}),a(),d(e)});